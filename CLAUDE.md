# CLAUDE.md — Day-Ready

## Project Overview

Day-Ready is a mobile-first personal morning routine and fitness planning web app. It helps users set daily to-dos, check weather, receive AI-generated morning briefs with outfit recommendations, plan weekly workouts with recurring schedules, prepare packing lists, manage evening prep checklists, follow daily stretch routines (built-in + custom), and calculate daily calorie needs.

## Architecture

**Single-file application.** The entire app lives in `index.html` (~977 lines) with embedded CSS and vanilla JavaScript. There is no build system, no bundler, no package manager, and no framework.

```
Day-Ready/
├── index.html    # Complete application (HTML + CSS + JS)
└── README.md     # Brief project description
```

### Code Layout within index.html

| Section | Description |
|---------|-------------|
| HTML head / CSS | CSS variables, all styles, animations (including stretch, calculator, todo, schedule styles) |
| HTML body | App shell, 5 pages, tab navigation |
| Toast component | Notification toast element |
| JS — State | Global state: `workouts`, `todos`, `weatherData`, `customStretches`, `scheduleTypes` |
| JS — Navigation | `switchTab()` tab switching |
| JS — Clock | `updateClock()` with 15s interval |
| JS — Todos | CRUD for daily to-do lists (tomorrow add/delete, today check/uncheck) |
| JS — Weather | Geolocation + Open-Meteo + reverse geocoding |
| JS — Morning Report | Claude API call + fallback report + rendering |
| JS — Evening Prep | Tomorrow's prep checklist by workout type |
| JS — Plan Page | Weekly plan view with activity bar |
| JS — Workouts | Workout CRUD, week strip, panel management |
| JS — Pack | Packing list generation by workout type |
| JS — Stretches | `STRETCH_MAP` data + `renderStretches()` — workout-specific + general + custom stretches |
| JS — Calorie Calculator | `loadCalcProfile()`, `autoDetectActivity()`, `calculateCalories()` — Mifflin-St Jeor equation |
| JS — Schedule | `applySchedule()`, `clearSchedule()` — recurring workout scheduling |
| JS — Custom Stretches | `addCustomStretch()`, `deleteCustomStretch()` — user-added stretches |
| JS — Notifications | Web Notification API scheduling |
| JS — Utils | `showToast()` |
| JS — Init | App initialization calls |

## Tech Stack

- **HTML5 / CSS3 / Vanilla JavaScript** — no frameworks, no dependencies
- **CSS Custom Properties** for theming (dark theme)
- **localStorage** for all data persistence (no backend database)
- **ES6+** features: async/await, arrow functions, template literals, optional chaining

## External APIs

| Service | Endpoint | Purpose | Auth |
|---------|----------|---------|------|
| Anthropic Claude | `https://api.anthropic.com/v1/messages` | AI morning briefs | API key required (model: `claude-sonnet-4-20250514`) |
| Open-Meteo | `https://api.open-meteo.com/v1/forecast` | Weather data (°F, mph) | None (free) |
| OpenStreetMap Nominatim | `https://nominatim.openstreetmap.org/reverse` | Reverse geocoding | None (free) |
| Google Fonts | CDN | DM Sans + DM Mono fonts | None |

## Browser APIs Used

- **Geolocation API** — user location for weather
- **Web Notifications API** — scheduled morning notifications
- **localStorage API** — all user data persistence
- **Fetch API** — external service calls

## Data Model (localStorage)

| Key | Format | Description |
|-----|--------|-------------|
| `dr_workouts` | `{ "YYYY-M-D": { types: string[], note: string } }` | Workout schedule by date |
| `dr_todos` | `{ "todo-YYYY-M-D": [{ text: string, done: bool }] }` | Daily to-do lists by date |
| `dr_notif_time` | `"HH:MM"` | Notification time (default: `"07:00"`) |
| `dr_notif_enabled` | `"true" \| "false"` | Notification toggle state |
| `dr_calc_profile` | `{ sex, age, weight, heightFt, heightIn, activity }` | Calorie calculator user profile |
| `dr_custom_stretches` | `[{ t: string, h: string }]` | User-added custom stretches |

**Date key format:** `YYYY-M-D` (no zero-padding) generated by `dayKey(d)` — e.g., `"2026-1-5"` not `"2026-01-05"`.

**Workout types (9):** Run, Lift, Bike, Swim, Yoga, HIIT, Walk, Sport, Ruck

## App Pages

1. **Morning** (`#page-morning`) — Clock, today's to-do checklist, tomorrow's to-do editor, weather hero card, AI morning brief, evening prep checklist
2. **Plan** (`#page-plan`) — Weekly activity bar, day-by-day workout overview, to-do summary
3. **Train** (`#page-workouts`) — Week strip day selector, workout editor panel, saved workout list, quick schedule (recurring workouts)
4. **Pack** (`#page-pack`) — Auto-generated packing lists per workout day with checkable items
5. **Body** (`#page-body`) — Workout-specific daily stretches with hold times, custom stretch input, calorie calculator (Mifflin-St Jeor equation) with profile persistence

## Design System

- **Theme:** Dark (background `#111111`, text `#e8e4df`)
- **Accent colors:** Tan `#c4a882`, sage green `#8fbf8f`, amber `#c9a96e`, red `#c47070`
- **Typography:** DM Sans (UI text, weight 300/400/500), DM Mono (data/labels, weight 300/400/500)
- **Layout:** Max-width 430px, mobile-first, iOS safe area handling
- **Animations:** Fade-in transitions (`fadeIn` keyframes), smooth page transitions

## Development Workflow

### Running Locally

Open `index.html` directly in a browser, or serve with any HTTP server:

```bash
# Python
python3 -m http.server 8000

# Node.js
npx serve .
```

Note: Geolocation and Notifications require HTTPS or localhost.

### No Build Steps

There is no build, transpilation, or bundling. Edit `index.html` directly and reload the browser.

### No Tests

There is no test framework or automated testing configured.

### No Linter/Formatter

There is no ESLint, Prettier, or other code quality tooling configured.

## Key Conventions

- **All code in one file** — do not split into separate CSS/JS files without explicit instruction
- **Inline styles** are used in dynamically generated HTML (template literals)
- **Function naming:** camelCase, descriptive (e.g., `loadTodos`, `buildWeekStrip`, `renderPackList`)
- **No semicolons** in some compact statements; mixed style — match surrounding code
- **Compact formatting** — many functions are written in a compressed single-line style
- **Comments** use `// ═══════ SECTION ═══════` dividers for major code sections
- **DOM manipulation** is done via `innerHTML` with template literals and direct `getElementById`
- **Error handling** uses try/catch with silent fallbacks (no error logging to console)
- **Data maps** (`PACK_MAP`, `EVENING_MAP`, `STRETCH_MAP`, `WMO_CODES`, `WMO_ICONS`) define item-to-content mappings as plain objects

## Important Implementation Details

- The Claude API call in `generateMorningReport()` sends weather + workout + to-do context and expects a JSON response. A `buildFallbackReport()` provides temperature-based defaults if the API fails.
- Weather units are Fahrenheit and mph (hardcoded in the Open-Meteo API call).
- Notification scheduling uses `setTimeout` with millisecond offsets from now until the target time. It re-schedules itself after firing.
- The week always starts on Sunday (calculated via `d.getDay()`).
- Evening prep and packing lists are derived from the `EVENING_MAP` and `PACK_MAP` objects keyed by workout type.
- Daily stretches in `STRETCH_MAP` are organized per workout type, with a `General` key for rest-day / recovery stretches. Each stretch has emoji (`e`), text (`t`), and hold time (`h`). Custom stretches from `dr_custom_stretches` are rendered in a "Your Stretches" section.
- The calorie calculator uses the Mifflin-St Jeor equation: `BMR = 10×weight(kg) + 6.25×height(cm) - 5×age + 5` (male) or `- 161` (female). TDEE = BMR × activity multiplier. Inputs are imperial (lbs, ft/in) and converted internally.
- `autoDetectActivity()` sets the activity dropdown based on the number of workouts scheduled in the current week.
- The Quick Schedule feature (`applySchedule`) places selected workout types on the current week at a chosen frequency (every N days starting from Sunday). It merges with existing workouts. `clearSchedule` removes all workouts for the current week.
- Tomorrow's to-do list replaces the former single-intention system. Items are stored as arrays of `{text, done}` objects. Today's items can be checked off; tomorrow's items can be added/deleted.
